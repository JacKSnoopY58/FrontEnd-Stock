import{a as n}from"./upsvKRUO.js";import{a as g}from"./Cz0CWeBA.js";import{_ as m,c as p,a as e,n as i,v as u,p as h,F as T,q as f,m as y,o as l,t as v}from"./Bpht06DM.js";const w={data(){return{postdata:{productName:"",productType:"",productTotal:"",productPicture:null},previewImage:null,productType:[],newType:"",isAddingNewType:!1,token:g.get("token")}},mounted(){this.fetchProductTypes()},methods:{handleImageUpload(r){const t=r.target.files[0];t&&(this.postdata.productPicture=t,this.previewImage=URL.createObjectURL(t))},navigateToPage(){this.$router.push("/admin/product")},handleProductTypeChange(){this.postdata.productType==="add-new"&&(this.isAddingNewType=!0,this.postdata.productType="")},async fetchProductTypes(){try{const r=await n.get("https://project-stock.onrender.com/api/products/get/producttype",{headers:{Authorization:`Bearer ${this.token}`}});this.productType=r.data.data}catch(r){console.error("เกิดข้อผิดพลาดในการดึงประเภทสินค้า:",r)}},async addProductType(){if(!this.postdata.productName||!this.postdata.productType||!this.postdata.productTotal||!this.postdata.productPicture){alert("กรุณากรอกข้อมูลให้ครบถ้วน");return}try{const{data:r}=await n.post("https://project-stock.onrender.com/api/products/addtype",{headers:{Authorization:`Bearer ${this.token}`}},{typeName:this.newType});this.productType.push({id:r.id,typeName:this.newType}),this.newType="",this.isAddingNewType=!1,alert("เพิ่มประเภทสินค้าเรียบร้อย")}catch(r){console.error("Add New type error:",r)}},async addProduct(){var r,t;try{if(!this.postdata.productName||!this.postdata.productType||!this.postdata.productTotal||!this.postdata.productPicture){alert("กรุณากรอกข้อมูลให้ครบถ้วน");return}const a={...this.postdata};console.log(a),console.log(this.postdata);const c=await n.post("https://project-stock.onrender.com/api/products/add",a,{headers:{"Content-Type":"multipart/form-data"},Authorization:`Bearer ${this.token}`});console.log(c),alert("เพิ่มสินค้าสำเร็จ"),this.$router.push("/admin/product")}catch(a){console.error("Error adding product:",a),alert(((t=(r=a.response)==null?void 0:r.data)==null?void 0:t.message)||"เกิดข้อผิดพลาดในการเพิ่มสินค้า")}}}},b={class:"p-5 lg:py-5 lg:px-20"},P={class:"bg-gray-200 p-10 mt-5 rounded-xl"},x={class:"flex flex-col-reverse sm:grid sm:grid-cols-2 gap-5"},k={class:"grid gap-y-5"},N={class:"grid grid-cols-1 gap-5 sm:grid-cols-2"},C=["value"],A={key:0,class:"mt-3"},U={key:0,class:"mt-3"},I=["src"],j={class:"flex justify-center mt-20 gap-20"};function B(r,t,a,c,d,s){return l(),p("div",b,[t[15]||(t[15]=e("div",null,[e("h1",{class:"text-3xl font-semibold"},"Add Product")],-1)),e("div",P,[e("div",x,[e("div",k,[e("div",null,[t[9]||(t[9]=e("label",{for:"pname",class:"block"},"ชื่อสินค้า",-1)),i(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>d.postdata.productName=o),class:"border rounded w-full p-1",required:""},null,512),[[u,d.postdata.productName]])]),e("div",N,[e("div",null,[t[12]||(t[12]=e("label",{for:"productType",class:"block"},"ประเภทสินค้า",-1)),i(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>d.postdata.productType=o),onChange:t[2]||(t[2]=(...o)=>s.handleProductTypeChange&&s.handleProductTypeChange(...o)),class:"select select-bordered w-full max-w-xs"},[t[10]||(t[10]=e("option",{disabled:"",value:""},"เลือกประเภทสินค้า",-1)),(l(!0),p(T,null,f(d.productType,o=>(l(),p("option",{key:o.id,value:o.id},v(o.typeName),9,C))),128)),t[11]||(t[11]=e("option",{value:"add-new"},"+ เพิ่มประเภทสินค้าใหม่",-1))],544),[[h,d.postdata.productType]])]),d.isAddingNewType?(l(),p("div",A,[i(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=o=>d.newType=o),placeholder:"ชื่อประเภทสินค้าใหม่",class:"border rounded w-full p-1"},null,512),[[u,d.newType]]),e("button",{onClick:t[4]||(t[4]=(...o)=>s.addProductType&&s.addProductType(...o)),class:"bg-blue-500 text-white rounded px-3 py-1 mt-2 hover:bg-blue-700"}," เพิ่มประเภทสินค้า ")])):y("",!0),e("div",null,[t[13]||(t[13]=e("label",{for:"quantity",class:"block"},"จำนวน",-1)),i(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=o=>d.postdata.productTotal=o),class:"border rounded p-1 w-full",required:""},null,512),[[u,d.postdata.productTotal]])])])]),e("div",null,[t[14]||(t[14]=e("label",{for:"productPicture",class:"block"},"เพิ่มรูปภาพสินค้า",-1)),e("input",{type:"file",id:"productPicture",onChange:t[6]||(t[6]=(...o)=>s.handleImageUpload&&s.handleImageUpload(...o)),class:"border rounded w-full p-1",accept:"image/*"},null,32),d.previewImage?(l(),p("div",U,[e("img",{src:d.previewImage,alt:"Product Preview",class:"w-32 h-32 object-cover"},null,8,I)])):y("",!0)])]),e("div",j,[e("button",{onClick:t[7]||(t[7]=(...o)=>s.addProduct&&s.addProduct(...o)),class:"bg-gray-500 rounded px-5 py-1.5 text-white hover:bg-gray-800"}," Save "),e("button",{onClick:t[8]||(t[8]=(...o)=>s.navigateToPage&&s.navigateToPage(...o)),class:"bg-gray-500 rounded px-5 py-1.5 text-white hover:bg-gray-800"}," Cancel ")])])])}const D=m(w,[["render",B]]);export{D as default};
